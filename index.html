<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Salario Catorcenal de Piloto (Estimación)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .result-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 0.5rem 1.5rem;
            align-items: center;
        }
        .result-grid span:nth-child(odd) {
            font-weight: 500;
            color: #4A5568; /* gray-700 */
        }
        .result-grid span:nth-child(even) {
            font-weight: 600;
            text-align: right;
            color: #1A202C; /* gray-900 */
        }
        .result-grid .net-pay {
            font-size: 1.25rem;
            font-weight: 700;
            color: #2F855A; /* green-700 */
        }
        .form-group {
            display: flex;
            flex-direction: column;
        }
        .form-grid {
             display: grid;
             grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
             gap: 1.5rem;
        }
        select:disabled {
            background-color: #E2E8F0; /* gray-300 */
            cursor: not-allowed;
        }
        hr {
            grid-column: 1 / -1;
            border-color: #CBD5E0; /* gray-400 */
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto max-w-4xl bg-white p-6 sm:p-8 my-8 rounded-xl shadow-lg">
        <div class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-blue-800">Calculadora de Salario de Piloto</h1>
            <p class="text-gray-600 mt-2">Estimación basada en CCT AVSA (Tabulador Oficial Oct. 2024)</p>
            <p class="text-gray-500 text-sm mt-1">Creado por BAZAN</p>
        </div>

        <form id="salaryForm">
            <fieldset class="border border-gray-300 rounded-lg p-4 mb-6">
                <legend class="text-lg font-bold text-blue-700 px-2">Datos para Cálculo</legend>
                <div class="form-grid mt-4">
                    <div class="form-group">
                        <label for="tipoContrato" class="mb-1 font-medium text-gray-700">Tipo de Contrato:</label>
                        <select id="tipoContrato" name="tipoContrato" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="contratoB">Contrato Post-2010</option>
                            <option value="contratoA">Contrato Pre-2010</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="anosAntiguedad" class="mb-1 font-medium text-gray-700">Años de Antigüedad:</label>
                        <input type="number" id="anosAntiguedad" name="anosAntiguedad" placeholder="Ej: 8" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="posicion" class="mb-1 font-medium text-gray-700">Posición:</label>
                        <select id="posicion" name="posicion" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="comandante">Comandante</option>
                            <option value="copiloto">Copiloto</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="equipo" class="mb-1 font-medium text-gray-700">Equipo:</label>
                        <select id="equipo" name="equipo" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="737">B737</option>
                            <option value="787">B787</option>
                        </select>
                    </div>
                     <div class="form-group">
                        <label for="esAsesor" class="mb-1 font-medium text-gray-700">¿Es Asesor/Instructor?</label>
                        <select id="esAsesor" name="esAsesor" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="no">No</option>
                            <option value="si">Sí</option>
                        </select>
                    </div>
                     <div class="form-group">
                        <label for="vacaciones" class="mb-1 font-medium text-gray-700">¿Vacaciones?</label>
                        <select id="vacaciones" name="vacaciones" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="no">No</option>
                            <option value="si">Sí (Calcular Prima)</option>
                        </select>
                    </div>
                </div>
            </fieldset>

            <fieldset class="border border-gray-300 rounded-lg p-4 mb-6">
                <legend class="text-lg font-bold text-blue-700 px-2">Conceptos de Pago Variables (Mensuales)</legend>
                <div class="form-grid mt-4">
                    <div class="form-group">
                        <label for="tvacHoras" class="mb-1 font-medium text-gray-700">TVAc (Tiempo Vuelo Acum.):</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="tvacHoras" value="74" placeholder="HH" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <span class="font-bold text-gray-500">:</span>
                            <input type="number" id="tvacMinutos" value="0" placeholder="MM" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="tesdHoras" class="mb-1 font-medium text-gray-700">TESD (T.E. Servicio Diario):</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="tesdHoras" value="0" placeholder="HH" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <span class="font-bold text-gray-500">:</span>
                            <input type="number" id="tesdMinutos" value="0" placeholder="MM" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="tevdHoras" class="mb-1 font-medium text-gray-700">TEVD (T.E. Vuelo Diario):</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="tevdHoras" value="0" placeholder="HH" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <span class="font-bold text-gray-500">:</span>
                            <input type="number" id="tevdMinutos" value="0" placeholder="MM" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                     <div class="form-group">
                        <label for="tevmHoras" class="mb-1 font-medium text-gray-700">TEVM (T.E. Vuelo Mensual):</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="tevmHoras" value="0" placeholder="HH" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <span class="font-bold text-gray-500">:</span>
                            <input type="number" id="tevmMinutos" value="0" placeholder="MM" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="jornadaNocturnaHoras" class="mb-1 font-medium text-gray-700">Jornada Nocturna:</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="jornadaNocturnaHoras" value="0" placeholder="HH" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <span class="font-bold text-gray-500">:</span>
                            <input type="number" id="jornadaNocturnaMinutos" value="0" placeholder="MM" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="eLearningHoras" class="mb-1 font-medium text-gray-700">E-Learning:</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="eLearningHoras" value="0" placeholder="HH" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <span class="font-bold text-gray-500">:</span>
                            <input type="number" id="eLearningMinutos" value="0" placeholder="MM" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="irreServHoras" class="mb-1 font-medium text-gray-700">IRRE. SERV.:</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="irreServHoras" value="0" placeholder="HH" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <span class="font-bold text-gray-500">:</span>
                            <input type="number" id="irreServMinutos" value="0" placeholder="MM" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                     <div class="form-group">
                        <label for="irreVloHoras" class="mb-1 font-medium text-gray-700">IRRE. VLO.:</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="irreVloHoras" value="0" placeholder="HH" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <span class="font-bold text-gray-500">:</span>
                            <input type="number" id="irreVloMinutos" value="0" placeholder="MM" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="redDesHoras" class="mb-1 font-medium text-gray-700">RED. DES.:</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="redDesHoras" value="0" placeholder="HH" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <span class="font-bold text-gray-500">:</span>
                            <input type="number" id="redDesMinutos" value="0" placeholder="MM" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                     <div class="form-group">
                        <label for="teReservaHoras" class="mb-1 font-medium text-gray-700">TE Reserva:</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="teReservaHoras" value="0" placeholder="HH" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <span class="font-bold text-gray-500">:</span>
                            <input type="number" id="teReservaMinutos" value="0" placeholder="MM" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="fo7Dia" class="mb-1 font-medium text-gray-700">FO/7° Día:</label>
                        <input type="number" id="fo7Dia" name="fo7Dia" value="0" placeholder="Días" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
            </fieldset>

            <fieldset class="border border-gray-300 rounded-lg p-4 mb-6">
                <legend class="text-lg font-bold text-blue-700 px-2">Deducciones (Catorcenal)</legend>
                 <div class="form-grid mt-4">
                    <div class="form-group">
                        <label for="aspenAdicional" class="mb-1 font-medium text-gray-700">ASPEN Adicional:</label>
                        <input type="number" id="aspenAdicional" name="aspenAdicional" value="0" placeholder="$" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="ajusteAspa" class="mb-1 font-medium text-gray-700">Ajuste ASPA:</label>
                        <input type="number" id="ajusteAspa" name="ajusteAspa" value="0" placeholder="$" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
            </fieldset>

            <div class="flex justify-center gap-4 mt-4">
                <button type="button" id="calculateBtn" class="px-8 py-3 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all">Calcular Salario</button>
                <button type="button" id="resetBtn" class="px-8 py-3 bg-gray-600 text-white font-bold rounded-lg shadow-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all">Limpiar</button>
            </div>
        </form>

        <div id="results" class="mt-10"></div>

    </div>

    <script>
        const CCT_DATA = {
            salarios: {
                contratoA: {
                    copiloto: {'737':[67925.51,69311.74,70726.31,72169.70,73642.55,75115.40,75115.40,75115.40,75115.40,76617.70,78150.06,79713.06,81307.32,82933.47,84592.14,86283.98,88009.66,89769.85,91565.25],'787':[79396.35,81016.68,82670.08,84357.20,86078.80,87800.38,87800.38,87800.38,87800.38,89556.39,91347.52,93174.47,95037.96,96938.71,98877.49,100855.04,102872.14,104929.58,107028.17]},
                    comandante: {'737':[111353.32,113625.83,115944.77,118310.98,120725.49,123140.00,123140.00,123140.00,123140.00,125602.80,128114.86,130677.15,133290.70,135956.51,138675.64,141449.15,144278.14,147163.70,150106.97],'787':[130157.95,132814.23,135524.78,138290.53,141112.82,143935.08,143935.08,143935.08,143935.08,146813.78,149750.06,152745.06,155799.96,158915.96,162094.28,165336.16,168642.89,172015.74,175456.06]}
                },
                contratoB: {
                    copiloto: {'737':[67925.51,69311.74,70726.31,72169.70,73642.55,75115.40,75115.40,75115.40,75115.40,76617.70,78150.06,79713.06,81307.32,82933.47,84592.14,86283.98,88009.66,89769.85,91565.25],'787':[79396.35,81016.68,82670.08,84357.20,86078.80,87800.38,87800.38,87800.38,87800.38,89556.39,91347.52,93174.47,95037.96,96938.71,98877.49,100855.04,102872.14,104929.58,107028.17]},
                    comandante: {'737':[111353.32,113625.83,115944.77,118310.98,120725.49,123140.00,123140.00,123140.00,123140.00,125602.80,128114.86,130677.15,133290.70,135956.51,138675.64,141449.15,144278.14,147163.70,150106.97],'787':[130157.95,132814.23,135524.78,138290.53,141112.82,143935.08,143935.08,143935.08,143935.08,146813.78,149750.06,152745.06,155799.96,158915.96,162094.28,165336.16,168642.89,172015.74,175456.06]}
                }
            },
            porcentajesAportaciones: { 
                contratoA: { sindical: 0.15, fcaa: 0.08, garantia: 0.57, tienda: 7542.21 },
                contratoB: { sindical: 0.06, fcaa: 0.05, reconocimiento: 0.06, equidad: 0.36 }
            },
            bonosFijos: {
                contratoA: {
                    reconocimiento: { copiloto: 3137.55, comandante: 5020.08 },
                    equidad: { copiloto: 1045.85, comandante: 1673.36 }
                }
            },
            costoHoraExtraVuelo: {
                contratoA: { '737': 847.79, '787': 1017.35 },
                contratoB: { '737': 593.45, '787': 712.15 }
            },
            despensaCatorcenal: 8476.52
        };

        // --- Helper functions ---
        function parseTime(horasId, minutosId) {
            const horas = parseFloat(document.getElementById(horasId).value) || 0;
            const minutos = parseFloat(document.getElementById(minutosId).value) || 0;
            return horas + (minutos / 60);
        }

        function getSalarioTabular(tc, pos, eq, yrs) {
            const tabulador = CCT_DATA.salarios[tc]?.[pos]?.[eq];
            if (!tabulador) return 0;
            const index = Math.max(0, yrs - 1);
            const finalIndex = Math.min(index, tabulador.length - 1);
            return tabulador[finalIndex] || 0;
        }

        function getSalarioMaximo(tc, eq) {
             const tabulador = CCT_DATA.salarios[tc]?.comandante?.[eq];
             if (!tabulador || tabulador.length === 0) return 0;
             return Math.max(...tabulador);
        }
        
        function getCostoHoraExtraVuelo(tc, eq) { return CCT_DATA.costoHoraExtraVuelo[tc]?.[eq] || 0; }
        
        function getDiasVacaciones(yrs) {
            if (yrs <= 0) return 0;
            if (yrs === 1) return 30;
            return 30 + (yrs - 1);
        }

        const currencyFormatter = new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN' });
        
        const posicionSelect = document.getElementById('posicion');
        const asesorSelect = document.getElementById('esAsesor');

        posicionSelect.addEventListener('change', () => {
            if(posicionSelect.value === 'copiloto') {
                asesorSelect.value = 'no';
                asesorSelect.disabled = true;
            } else {
                asesorSelect.disabled = false;
            }
        });
        
        document.getElementById('calculateBtn').addEventListener('click', calculateSalary);
        document.getElementById('resetBtn').addEventListener('click', resetForm);

        function calculateSalary() {
            // --- 1. READ & VALIDATE FORM DATA ---
            const tipoContrato = document.getElementById('tipoContrato').value;
            const anosAntiguedad = parseInt(document.getElementById('anosAntiguedad').value);
            const posicion = document.getElementById('posicion').value;
            const equipo = document.getElementById('equipo').value;
            const esAsesor = posicion === 'comandante' && document.getElementById('esAsesor').value === 'si';
            const isVacaciones = document.getElementById('vacaciones').value === 'si';

            if (isNaN(anosAntiguedad) || anosAntiguedad <= 0) {
                alert("Por favor, ingresa un número válido y mayor a 0 para los años de antigüedad.");
                return;
            }

            const tvac = parseTime('tvacHoras', 'tvacMinutos');
            const tesd = parseTime('tesdHoras', 'tesdMinutos');
            const tevd = parseTime('tevdHoras', 'tevdMinutos');
            const tevm = parseTime('tevmHoras', 'tevmMinutos');
            const jornadaNocturna = parseTime('jornadaNocturnaHoras', 'jornadaNocturnaMinutos');
            const eLearning = parseTime('eLearningHoras', 'eLearningMinutos');
            const irreServ = parseTime('irreServHoras', 'irreServMinutos');
            const irreVlo = parseTime('irreVloHoras', 'irreVloMinutos');
            const redDes = parseTime('redDesHoras', 'redDesMinutos');
            const teReserva = parseTime('teReservaHoras', 'teReservaMinutos');
            const fo7Dia = parseFloat(document.getElementById('fo7Dia').value) || 0;
            
            const isrPorcentaje = tipoContrato === 'contratoB' ? 34 : 35;
            const imssEstimado = 1079.86; 
            const aspenAdicional = parseFloat(document.getElementById('aspenAdicional').value) || 0;
            const ajusteAspa = parseFloat(document.getElementById('ajusteAspa').value) || 0;

            // --- 2. CALCULATE BASE EARNINGS ---
            const salarioTabularMensual = getSalarioTabular(tipoContrato, posicion, equipo, anosAntiguedad);
            const salarioDiarioTabular = salarioTabularMensual / 30;
            
            const p = CCT_DATA.porcentajesAportaciones[tipoContrato];
            const fcaaMensual = salarioTabularMensual * p.fcaa;
            const clausulaSindicalMensual = salarioTabularMensual * p.sindical;
            const despensaCatorcenal = CCT_DATA.despensaCatorcenal;
            
            let salarioOrdinarioDiario;
            let bonoRecMensual, besMensual;

            if (tipoContrato === 'contratoB') {
                bonoRecMensual = salarioTabularMensual * p.reconocimiento;
                besMensual = salarioTabularMensual * p.equidad;
                const salarioOrdinarioMensual = salarioTabularMensual + bonoRecMensual + besMensual + clausulaSindicalMensual + fcaaMensual;
                salarioOrdinarioDiario = salarioOrdinarioMensual / 30;
            } else { // Contrato A
                bonoRecMensual = CCT_DATA.bonosFijos.contratoA.reconocimiento[posicion] || 0;
                besMensual = CCT_DATA.bonosFijos.contratoA.equidad[posicion] || 0;
                const salarioOrdinarioMensual = salarioTabularMensual * (1 + p.garantia) + clausulaSindicalMensual + fcaaMensual + p.tienda;
                salarioOrdinarioDiario = salarioOrdinarioMensual / 30;
            }
            
            const sueldoCatorcenal = salarioDiarioTabular * 14;
            const bonoRecCatorcenal = (bonoRecMensual / 30) * 14;
            const besCatorcenal = (besMensual / 30) * 14;
            const fcaaCatorcenal = (fcaaMensual / 30) * 14;
            const clausulaSindicalCatorcenal = (clausulaSindicalMensual / 30) * 14;

            let compAsesorCatorcenal = 0;
            if (esAsesor) {
                const salarioMaximoCapitan = getSalarioMaximo(tipoContrato, equipo);
                const baseAsesor = salarioMaximoCapitan * 1.05;
                const compMensual = baseAsesor * 0.35;
                compAsesorCatorcenal = (compMensual / 30) * 14;
            }

            const percepcionesFijasSinDespensa = sueldoCatorcenal + besCatorcenal + bonoRecCatorcenal + fcaaCatorcenal + clausulaSindicalCatorcenal + compAsesorCatorcenal;

            // --- 3. CALCULATE VARIABLE & EXTRA PAYMENTS ---
            const costoHoraExtraVuelo = getCostoHoraExtraVuelo(tipoContrato, equipo);
            const pagoTEVM74 = Math.max(0, tvac - 74) * costoHoraExtraVuelo;
            const pagoTESD = tesd * (salarioTabularMensual * 0.01);
            const pagoTEVD = tevd * (salarioTabularMensual * (tipoContrato === 'contratoB' ? 0.0125 : 0.02));
            const pagoTEVM = tevm * (salarioTabularMensual * (tipoContrato === 'contratoB' ? 0.04 : 0.03));
            const pagoJornadaNocturna = jornadaNocturna * salarioDiarioTabular * 0.20;
            const pagoELearning = eLearning * 2 * (salarioDiarioTabular / 8);
            const pagoIrreServ = irreServ * salarioDiarioTabular * 0.25;
            const pagoIrreVlo = irreVlo * costoHoraExtraVuelo * 2;
            const pagoRedDes = redDes * salarioDiarioTabular * 0.25;
            const pagoFo7Dia = fo7Dia * salarioOrdinarioDiario * 3;
            const pagoTeReserva = teReserva * salarioDiarioTabular * 0.25;

            const totalPagosVariables = pagoTEVM74 + pagoTESD + pagoTEVD + pagoTEVM + pagoJornadaNocturna + pagoELearning + pagoIrreServ + pagoIrreVlo + pagoRedDes + pagoFo7Dia + pagoTeReserva;
            
            let primaVacacionalAnual = 0;
            if (isVacaciones) {
                const diasVacaciones = getDiasVacaciones(anosAntiguedad);
                const salarioVacaciones = salarioOrdinarioDiario * diasVacaciones;
                primaVacacionalAnual = (tipoContrato === 'contratoB') ? (salarioVacaciones * 0.30) : (salarioVacaciones * 1.50);
            }

            // --- 4. CALCULATE BI-WEEKLY PAYCHECKS ---
            const catorcenaAltaBruta = percepcionesFijasSinDespensa + totalPagosVariables + primaVacacionalAnual;
            const isrCatorcenaAlta = catorcenaAltaBruta * (isrPorcentaje / 100);
            const deduccionesCatorcenales = imssEstimado + aspenAdicional + ajusteAspa;
            const catorcenaAltaNeta = catorcenaAltaBruta - isrCatorcenaAlta - deduccionesCatorcenales;

            const catorcenaBajaBruta = percepcionesFijasSinDespensa + despensaCatorcenal;
            const isrCatorcenaBaja = catorcenaBajaBruta * (isrPorcentaje / 100);
            const catorcenaBajaNeta = catorcenaBajaBruta - isrCatorcenaBaja - deduccionesCatorcenales;

            // --- 5. GENERATE DETAILED HTML FOR RESULTS ---
            let desgloseVariablesHTML = '';
            const pagosVariables = {
                "T.E. Vuelo > 74h (TVAc)": pagoTEVM74,
                "T.E. Servicio Diario (TESD)": pagoTESD,
                "T.E. Vuelo Diario (TEVD)": pagoTEVD,
                "T.E. Vuelo Mensual (TEVM)": pagoTEVM,
                "Jornada Nocturna": pagoJornadaNocturna,
                "E-Learning": pagoELearning,
                "IRRE. SERV.": pagoIrreServ,
                "IRRE. VLO.": pagoIrreVlo,
                "RED. DES.": pagoRedDes,
                "FO/7° Día": pagoFo7Dia,
                "TE Reserva": pagoTeReserva
            };

            let hasVariables = Object.values(pagosVariables).some(v => v > 0);

            if (hasVariables) {
                desgloseVariablesHTML += `<hr><h4 class="text-md font-semibold text-blue-700 col-span-2 mt-2 mb-1">Desglose de Pagos Variables</h4>`;
                for (const [key, value] of Object.entries(pagosVariables)) {
                    if (value > 0) {
                        desgloseVariablesHTML += `<span>${key}:</span> <span>${currencyFormatter.format(value)}</span>`;
                    }
                }
            }
            
            const percepcionesFijasAltaHTML = `<h4 class="text-md font-semibold text-blue-700 col-span-2 mb-1">Desglose de Percepciones Fijas</h4>
                                               <span>Sueldo (14 días):</span> <span>${currencyFormatter.format(sueldoCatorcenal)}</span>
                                               ${esAsesor ? `<span>Comp. Asesor/Instructor:</span> <span>${currencyFormatter.format(compAsesorCatorcenal)}</span>` : ''}
                                               <span>Fondo Caja Contractual (FCAA):</span> <span>${currencyFormatter.format(fcaaCatorcenal)}</span>
                                               <span>Cláusula Sindical:</span> <span>${currencyFormatter.format(clausulaSindicalCatorcenal)}</span>
                                               <span>Bono de Reconocimiento:</span> <span>${currencyFormatter.format(bonoRecCatorcenal)}</span>
                                               <span>Bono de Equidad Salarial:</span> <span>${currencyFormatter.format(besCatorcenal)}</span>`;

            const percepcionesFijasBajaHTML = percepcionesFijasAltaHTML + `<span>Despensa:</span> <span>${currencyFormatter.format(despensaCatorcenal)}</span>`;

            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <h2 class="text-2xl font-bold text-blue-800 border-b-2 border-blue-200 pb-2 mb-6">Resultados de la Estimación</h2>
                 <div class="result-section bg-gray-50 border border-gray-200 p-6 rounded-lg mb-6">
                    <h3 class="text-xl font-bold text-gray-700 mb-4">Datos del Piloto</h3>
                     <div class="result-grid">
                        <span>Contrato Seleccionado:</span> <span>${document.getElementById('tipoContrato').options[document.getElementById('tipoContrato').selectedIndex].text}</span>
                        <span>Años de Antigüedad:</span> <span>${anosAntiguedad}</span>
                        <span>Salario Tabular Mensual:</span> <span>${currencyFormatter.format(salarioTabularMensual)}</span>
                        <span>Salario Diario Tabular:</span> <span>${currencyFormatter.format(salarioDiarioTabular)}</span>
                        <span>Salario Ordinario Diario:</span> <span>${currencyFormatter.format(salarioOrdinarioDiario)}</span>
                    </div>
                </div>

                <div class="result-section bg-blue-50 border border-blue-200 p-6 rounded-lg mb-6">
                    <h3 class="text-xl font-bold text-blue-700 mb-4">Estimación Catorcena con Extras ("Alta")</h3>
                    <div class="result-grid">
                        ${percepcionesFijasAltaHTML}
                        ${desgloseVariablesHTML}
                        ${isVacaciones ? `<hr><span>Prima Vacacional (Anual):</span> <span>${currencyFormatter.format(primaVacacionalAnual)}</span>` : ''}
                        <hr><hr>
                        <span><strong>Total Bruto Estimado:</strong></span> <span>${currencyFormatter.format(catorcenaAltaBruta)}</span>
                        <span>ISR Estimado (${isrPorcentaje}%):</span> <span class="text-red-600">-${currencyFormatter.format(isrCatorcenaAlta)}</span>
                        <span>Deducción IMSS:</span> <span class="text-red-600">-${currencyFormatter.format(imssEstimado)}</span>
                        <span>ASPEN Adicional:</span> <span class="text-red-600">-${currencyFormatter.format(aspenAdicional)}</span>
                        <span>Ajuste ASPA:</span> <span class="text-red-600">-${currencyFormatter.format(ajusteAspa)}</span>
                        <hr><hr>
                        <span><strong>Neto a Recibir Estimado:</strong></span> <span class="net-pay">${currencyFormatter.format(catorcenaAltaNeta)}</span>
                    </div>
                </div>

                <div class="result-section bg-gray-50 border border-gray-200 p-6 rounded-lg mb-6">
                    <h3 class="text-xl font-bold text-gray-700 mb-4">Estimación Catorcena Base ("Baja")</h3>
                     <div class="result-grid">
                        ${percepcionesFijasBajaHTML}
                        <hr><hr>
                        <span><strong>Total Bruto Estimado:</strong></span> <span>${currencyFormatter.format(catorcenaBajaBruta)}</span>
                        <span>ISR Estimado (${isrPorcentaje}%):</span> <span class="text-red-600">-${currencyFormatter.format(isrCatorcenaBaja)}</span>
                        <span>Deducción IMSS:</span> <span class="text-red-600">-${currencyFormatter.format(imssEstimado)}</span>
                        <span>ASPEN Adicional:</span> <span class="text-red-600">-${currencyFormatter.format(aspenAdicional)}</span>
                        <span>Ajuste ASPA:</span> <span class="text-red-600">-${currencyFormatter.format(ajusteAspa)}</span>
                        <hr><hr>
                        <span><strong>Neto a Recibir Estimado:</strong></span> <strong class="net-pay">${currencyFormatter.format(catorcenaBajaNeta)}</strong>
                    </div>
                </div>
                
                 <div class="info-section bg-teal-50 border-l-4 border-teal-500 p-4 rounded-r-lg">
                    <h3 class="text-lg font-bold text-teal-800">Aportaciones (Informativo Mensual)</h3>
                    <p class="text-teal-700 text-sm mt-1">Montos adicionales que la empresa aporta por ti.</p>
                    <div class="result-grid mt-2">
                        <span>Fondo de Ahorro (FCAA):</span> <span>${currencyFormatter.format(fcaaMensual)}</span>
                        <span>Cláusula Sindical:</span> <span>${currencyFormatter.format(clausulaSindicalMensual)}</span>
                    </div>
                </div>
            `;
        }

        function resetForm() {
            document.getElementById('salaryForm').reset();
            document.getElementById('results').innerHTML = '';
        }
    </script>

</body>
</html>
